<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bulma CSS 링크 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- 텍스트형태로 되어있는 icon 을 쓸 수 있도록 Font awesome 을 포함하빈다. -->
    <script defer src="https://use.fontawesome.com/releases/v6.4.0/js/all.js"></script>
    <!-- 타이틀 확인 -->

    <!-- 아이콘 -->
    <title>회원가입</title>
    <style>
        .textset {
            margin: 0 20px;
            padding-right: 100px;
        }

        .submit {
            margin-top: 50px;
        }
    </style>
</head>

<body>
    <div class="container">

        <section class="section">
            <div class="has-text-left">
                <h2 class="title">회원가입</h2>
            </div>
        </section>
        
        <!-- 회원가입 텍스트 -->
        <div class="textset">
            <!-- 이름 -->
            <div class="field">
                <label for="username" class="label">이름</label>
                <div class="control has-icons-left has-icons-right">
                    <input id="username" name="username" class="input " type="text" placeholder="이름" value="" required>
                    <span class="icon is-small is-left">
                        <i class="fas fa-user"></i>
                    </span>
                    
                </div>
            </div>

            <!-- 강의실 -->
            <div class="field">
                <label for="classR" class="label">강의실</label>
                <div class="control">
                    <input id="classR" name="classR" class="input" type="text" placeholder="배정받은 강의실을 입력해주세요" required>
                </div>
            </div>

            <!-- 사용OS -->
            <div class="field">
                <label for="classR" class="label">사용중인 OS</label>
                <div class="control">
                    <div class="select">
                        <select>
                            <option>Window</option>
                            <option>MAC</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 이메일 -->
            <div class="field">
                <label for="Email" class="label">Email</label>
                <div class="control has-icons-left has-icons-right">
                    <input class="input" id="Email" name="Email"  type="email" placeholder="이메일을 입력해주세요" value="" required>
                    <span class="icon is-small is-left">
                        <i class="fas fa-envelope"></i>
                    </span>
                    
                </div>
            </div>
            <!-- 패스워드, 확인 -->
            <div class="field">
                <label for="password" class="label">패스워드</label>
                <div class="control">
                    <input class="input" id="password" name="password" type="password" placeholder="" required>
                </div>
            </div>

            <div class="field">
                <label for="password2" class="label">패스워드 확인</label>
                <div class="control">
                    <input class="input" id="password2" name="password2" type="password" placeholder="" required>
                </div>
            </div>


            <!-- 가입 버튼 -->
            <div class="submit">
                <div class="field is-grouped">
                    <div class="control">
                        <button class="button is-primary">가입</button>
                    </div>
                    <div class="control">
                        <button class="button is-link is-light">취소</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function registerUser() {
            const username = document.getElementById("username").value;
            const classR = document.getElementById("classR").value;
            const OS = document.getElementById("OS").value;

            //장소 정보 저장되는지 테스트  
            const place = document.getElementById("place").value;


            const Email = document.getElementById("Email").value;
            const ID = document.getElementById("ID").value;
            const password = document.getElementById("password").value;
            const password2 = document.getElementById("password2").value;

            if (!username || !classR || !OS || !Email || !ID || !password || !password2) {
                alert("모든 정보를 입력하세요.");
                return;
            }

            if (password !== password2) {
                alert("비밀번호가 일치하지 않습니다. 다시 입력해주세요.");
                return;
            }

            const response = await fetch("http://localhost:5001/register", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ username, classR, OS, place, Email, ID, password, password2 })
            });

            const result = await response.json();
            //alert("회원가입 완료! 로그인 페이지로 이동합니다.");
            
            if(result.result === "success") {
                window.location.href = "login.html";  // 로그인 페이지로 이동
            }
            alert(result.message);
        }
    </script>
</body>

</html>