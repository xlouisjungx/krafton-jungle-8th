<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bulma CSS 링크 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
  <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <title>{{title}}</title>

  <style>
    .post-button {
      display: flex;
      justify-content: right;
      margin-right: 5%;
    }
  </style>

  <!-- JS Function -->
  <script>
    $(document).ready(function () {
        $("#post-display").html("");
        showPosts();
    });

    function showPosts() {
      $.ajax({
        type: "GET",
        url: "/main_post",
        data: {},
        success: function (response) {
          let posts = response["posts"];
          for (let i = 0; i < posts.length; i++) {
            console.log(posts[i])
            makePost(posts[i]["image"], posts[i]["poster_id"], posts[i]["post_title"], posts[i]["post_content"], posts[i]["link"], posts[i]["like"], posts[i]["post_time"])
          }

          if (posts.length === 0) {
            makePost('', '', '게시글 없음', '', '', '', '', '')
          }
        }
      })
    }

    function makePost(image, poster_id, post_title, post_content, link, likes, post_time) {
      console.log(image)
      let temp_html = `<div class="tile is-parent">
                          <article class="tile is-child box">
                            <p class="subtitle">${post_time}</p>
                            <figure class="image">
                              <img src="${image}">
                            </figure>
                            <p class="title">${post_title}</p>
                            <p class="subtitle">${post_content}</p>
                          </article>
                      </div>`;
      $("#post-display").append(temp_html);
    }
  </script>
</head>

<body>
  <section class="section">
    <div class="container has-text-centered">
      <h2 class="title">{{heading}}</h2>
      <p>{{sub_head}}</p>
    </div>
  </section>

  <div class="post-button">
    <a href="/post">
      <button class="button is-link">{{post}}</button>
    </a>
  </div>

  <div id="post-display"> 
  </div>

</body>
</html>